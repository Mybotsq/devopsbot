FROM postgres

ARG DB_REPL_USER
ARG DB_REPL_PASSWORD

ENV POSTGRES_USER=${DB_USER}
ENV POSTGRES_PASSWORD=${DB_PASSWORD}
ENV POSTGRES_DB=${DB_DATABASE}

ADD init_db.sql /docker-entrypoint-initdb.d/

RUN echo "CREATE USER ${DB_REPL_USER} WITH REPLICATION ENCRYPTED PASSWORD '${DB_REPL_PASSWORD}';" >> /docker-entrypoint-initdb.d/init_db.sql

EXPOSE 5432


